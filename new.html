<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Numo ‚Ä¢ A Special Request</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#fff0f7;
      --bg2:#ffe6f2;
      --bg3:#f6f0ff;
      --bg4:#eaf6ff;

      --rose:#ff4da0;
      --rose2:#ff86c8;

      --text:#7a2b62;
      --muted: rgba(122,43,98,.70);

      --stroke: rgba(255,255,255,.85);
      --shadow: 0 22px 70px rgba(122,43,98,.18);

      --noBg: rgba(255,255,255,.80);
      --noStroke: rgba(122,43,98,.14);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:24px;
      color:var(--text);
      font-family: "Manrope", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 600px at 18% 18%, var(--bg4), transparent 60%),
        radial-gradient(900px 600px at 82% 28%, var(--bg3), transparent 60%),
        radial-gradient(1000px 700px at 50% 88%, #fff7fb, transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2) 45%, #f3eaff 100%);
      overflow:hidden;
    }

    /* premium shimmer dust */
    body:before{
      content:"";
      position:fixed;
      inset:-20%;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 35%),
        radial-gradient(circle at 70% 35%, rgba(255,255,255,.45), transparent 38%),
        radial-gradient(circle at 40% 70%, rgba(255,255,255,.50), transparent 36%);
      filter: blur(22px);
      pointer-events:none;
      opacity:.55;
    }

    /* floating hearts background layer */
    #bgFloat{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:1;
      overflow:hidden;
    }
    .floatItem{
      position:absolute;
      bottom:-40px;
      opacity:.10; /* subtle */
      filter: blur(.2px);
      animation: floatUp linear forwards;
      transform: translateY(0);
      user-select:none;
      white-space:nowrap;
      text-shadow: 0 0 10px rgba(255,77,160,.12);
    }
    @keyframes floatUp{
      from{ transform: translateY(0) translateX(0) scale(.95); opacity:.02; }
      10%{ opacity:.11; }
      to{ transform: translateY(-120vh) translateX(40px) scale(1.05); opacity:0; }
    }

    .card{
      width:min(920px, 94vw);
      padding:clamp(18px, 3.6vw, 38px);
      border-radius:28px;
      background:linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,.52));
      box-shadow:var(--shadow);
      backdrop-filter: blur(14px);
      position:relative;
      overflow:hidden;
      z-index:2;
    }

    /* animated premium border glow */
    .card:before{
      content:"";
      position:absolute;
      inset:-2px;
      border-radius:30px;
      padding:2px;
      background: linear-gradient(120deg,
        rgba(255,77,160,.55),
        rgba(255,255,255,.65),
        rgba(255,134,200,.55));
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity:.65;
      filter: blur(.2px);
      animation: borderFlow 5s linear infinite;
      pointer-events:none;
    }
    @keyframes borderFlow{
      0%{ transform: rotate(0deg); }
      100%{ transform: rotate(360deg); }
    }

    .topRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:14px;
      flex-wrap:wrap;
      position:relative;
      z-index:2;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.62);
      border:1px solid rgba(122,43,98,.10);
      font-weight:700;
      font-size:12.5px;
      letter-spacing:.4px;
      text-transform:uppercase;
      color:rgba(122,43,98,.78);
    }

    h1{
      margin:12px 0 10px;
      font-family:"Playfair Display", Georgia, serif;
      font-size:clamp(28px, 4vw, 54px);
      line-height:1.08;
      text-align:center;
      letter-spacing:.3px;
      animation: fadeUp .8s ease both;
      background: linear-gradient(135deg, #8a2d62, #ff4da0);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      position:relative;
      z-index:2;
    }

    .hint{
      text-align:center;
      margin:0 0 18px;
      color:var(--muted);
      font-size:clamp(14px, 1.7vw, 16px);
      animation: fadeUp .9s ease both;
      animation-delay:.08s;
      position:relative;
      z-index:2;
    }

    .stage{ display:grid; place-items:center; margin-top:8px; position:relative; z-index:2; }

    .playArea{
      width:min(760px, 92vw);
      height:300px;
      position:relative;
      border-radius:24px;
      border:1px solid rgba(255,255,255,.85);
      background:
        radial-gradient(900px 420px at 50% 0%, rgba(255,255,255,.70), transparent 65%),
        rgba(255,255,255,.22);
      overflow:hidden;
      padding:18px;
    }

    /* subtle inner glow */
    .playArea:before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.55), transparent 45%);
      opacity:.35;
      pointer-events:none;
    }

    .btnRow{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%, -50%);
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:center;
      width: fit-content;
      z-index:2;
    }

    button{
      border:0;
      cursor:pointer;
      border-radius:999px;
      font-weight:800;
      letter-spacing:.2px;
      width: 156px;
      height: 52px;
      font-size:16px;
      outline:none;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: box-shadow .22s ease, opacity .22s ease, left .25s ease, top .25s ease, transform .22s ease;
      position:relative;
    }

    /* IRRESISTIBLE YES */
    .yes{
      --ys: 1;
      --glow: 0.30;
      background: linear-gradient(135deg, var(--rose), var(--rose2));
      color:#fff;
      box-shadow: 0 16px 36px rgba(255,77,160,.22);
      transform: scale(var(--ys));
      overflow:hidden;
      will-change: transform, box-shadow;
      animation: heartbeat 1.55s ease-in-out infinite;
    }

    /* halo ring */
    .yes .ring{ display:none; } /* (placeholder if you ever wrap, not needed) */
    .yes:after{
      content:"";
      position:absolute;
      inset:-10px;
      border-radius:999px;
      background: radial-gradient(circle at 50% 40%, rgba(255,255,255,.60), transparent 55%);
      opacity: calc(var(--glow));
      filter: blur(10px);
      pointer-events:none;
    }

    /* glossy sweep */
    .yes:before{
      content:"";
      position:absolute;
      inset:-40%;
      background: linear-gradient(120deg, transparent 35%, rgba(255,255,255,.55) 50%, transparent 65%);
      transform: translateX(-60%) rotate(10deg);
      opacity:.55;
      pointer-events:none;
      animation: shine 2.4s ease-in-out infinite;
    }

    @keyframes heartbeat{
      0%, 100%{ transform: scale(var(--ys)); }
      40%{ transform: scale(calc(var(--ys) * 1.04)); }
      55%{ transform: scale(calc(var(--ys) * 0.99)); }
      72%{ transform: scale(calc(var(--ys) * 1.03)); }
    }

    @keyframes shine{
      0%{ transform: translateX(-70%) rotate(10deg); }
      55%{ transform: translateX(70%) rotate(10deg); }
      100%{ transform: translateX(70%) rotate(10deg); }
    }

    .no{
      background: var(--noBg);
      color: rgba(122,43,98,.90);
      border: 1px solid var(--noStroke);
      box-shadow: 0 14px 30px rgba(122,43,98,.12);
      position:relative;
      transform: scale(1);
      will-change: left, top, transform, opacity;
      backdrop-filter: blur(10px);
    }

    .msg{
      margin-top:16px;
      min-height:58px;
      display:grid;
      place-items:center;
      text-align:center;
      font-family:"Playfair Display", Georgia, serif;
      font-size:clamp(18px, 2.2vw, 24px);
      padding:8px 12px;
      color:rgba(122,43,98,.92);
    }

    .final{
      margin-top:12px;
      text-align:center;
      font-family:"Playfair Display", Georgia, serif;
      font-size:clamp(20px, 2.4vw, 26px);
      color:rgba(122,43,98,.90);
      animation: fadeUp .7s ease both;
      min-height: 34px;
    }

    .dramatic{
      text-shadow: 0 10px 40px rgba(255,77,160,.16);
      animation: dramaticIn 1.05s ease both;
    }

    .legendaryYes{
      font-size: clamp(20px, 2.4vw, 30px) !important;
      color: rgba(122,43,98,.95) !important;
      text-shadow: 0 0 26px rgba(255,77,160,.20), 0 18px 60px rgba(255,77,160,.12);
    }

    .toBe{
      margin-top: 10px;
      font-family:"Playfair Display", Georgia, serif;
      font-size: clamp(16px, 2vw, 20px);
      letter-spacing: .8px;
      color: rgba(122,43,98,.72);
      opacity:0;
      animation: fadeUp .9s ease forwards;
    }

    /* Modal */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      padding:20px;
      background:rgba(20,6,37,.35);
      z-index:60;
      backdrop-filter: blur(6px);
    }
    .modalCard{
      width:min(520px, 92vw);
      border-radius:22px;
      border:1px solid rgba(255,255,255,.75);
      background:linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.55));
      box-shadow: 0 24px 90px rgba(122,43,98,.22);
      overflow:hidden;
      transform: translateY(12px) scale(.98);
      opacity:0;
      animation: modalIn .45s ease forwards;
    }
    .gifWrap{ width:100%; background:rgba(255,255,255,.40); }
    .gifWrap img{ width:100%; display:block; }
    .modalBody{ padding:14px 16px 18px; text-align:center; }
    .modalTitle{
      font-family:"Playfair Display", Georgia, serif;
      color:rgba(122,43,98,.92);
      font-size:18px;
      margin:6px 0 0;
    }
    .modalHint{ margin:8px 0 0; color:rgba(122,43,98,.70); font-size:14px; }
    .closeBtn{
      margin-top:12px;
      width:auto;
      height:auto;
      padding:10px 16px;
      background:rgba(255,77,160,.12);
      border:1px solid rgba(255,77,160,.18);
      color:rgba(122,43,98,.88);
      font-weight:800;
      border-radius:999px;
    }

    /* Sparkle layer */
    #sparkleLayer{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:58;
      overflow:hidden;
    }
    .sparkle{
      position:absolute;
      font-family:"Playfair Display", Georgia, serif;
      color:rgba(255,77,160,.85);
      text-shadow: 0 0 16px rgba(255,77,160,.22);
      opacity:0;
      animation: floatSparkle linear forwards;
      white-space:nowrap;
    }
    @keyframes floatSparkle{
      0%   { transform: translateY(40px) scale(.95); opacity:0; }
      10%  { opacity:.95; }
      100% { transform: translateY(-120vh) scale(1.05); opacity:0; }
    }

    /* Flash */
    #flash{
      position:fixed;
      inset:0;
      background:white;
      opacity:0;
      pointer-events:none;
      z-index:70;
    }
    .flashOn{ animation: flash .45s ease both; }
    @keyframes flash{
      0%{ opacity:0; }
      18%{ opacity:.70; }
      100%{ opacity:0; }
    }

    /* Stamp */
    #stamp{
      position:fixed;
      left:50%;
      top:42%;
      transform: translate(-50%, -50%) rotate(-12deg) scale(.6);
      opacity:0;
      z-index:72;
      pointer-events:none;
      width:min(360px, 85vw);
      text-align:center;
      padding:22px 18px;
      border-radius:22px;
      border:2px solid rgba(255,77,160,.30);
      background:linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.55));
      box-shadow: 0 30px 120px rgba(122,43,98,.20);
      backdrop-filter: blur(10px);
    }
    .stampRing{
      display:inline-block;
      padding:10px 18px;
      border-radius:999px;
      border:2px dashed rgba(255,77,160,.55);
      color: rgba(122,43,98,.92);
      font-family:"Playfair Display", Georgia, serif;
      font-weight:700;
      letter-spacing: 1.6px;
      text-transform:uppercase;
      text-shadow: 0 0 14px rgba(255,77,160,.18);
    }
    .stampName{
      margin-top:12px;
      font-family:"Playfair Display", Georgia, serif;
      font-weight:800;
      letter-spacing: 2.4px;
      font-size: clamp(22px, 3vw, 30px);
      background: linear-gradient(135deg, #8a2d62, #ff4da0);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .stampSub{
      margin-top:8px;
      font-family:"Manrope", sans-serif;
      color: rgba(122,43,98,.70);
      font-weight:800;
      letter-spacing:.3px;
    }
    .stampSlam{ animation: slam 1.2s cubic-bezier(.15,.95,.25,1) both; }
    @keyframes slam{
      0%{ opacity:0; transform: translate(-50%, -50%) rotate(-18deg) scale(.4); filter: blur(2px); }
      35%{ opacity:1; transform: translate(-50%, -50%) rotate(-12deg) scale(1.18); filter: blur(0); }
      55%{ transform: translate(-50%, -50%) rotate(-12deg) scale(.98); }
      100%{ opacity:1; transform: translate(-50%, -50%) rotate(-12deg) scale(1); }
    }
    .stampOut{ animation: stampOut .9s ease both; }
    @keyframes stampOut{ to{ opacity:0; transform: translate(-50%, -52%) rotate(-12deg) scale(.98); } }

    canvas#fx{ position:fixed; inset:0; pointer-events:none; z-index:55; }

    @keyframes fadeUp{ from{ opacity:0; transform: translateY(10px);} to{ opacity:1; transform: translateY(0);} }
    @keyframes modalIn{ to{ transform: translateY(0) scale(1); opacity:1;} }
    @keyframes dramaticIn{
      0%{ transform: translateY(16px) scale(.96); opacity:0; filter: blur(2px); }
      60%{ transform: translateY(-2px) scale(1.02); opacity:1; filter: blur(0); }
      100%{ transform: translateY(0) scale(1); }
    }
  </style>
</head>

<body>
  <div id="bgFloat" aria-hidden="true"></div>
  <canvas id="fx"></canvas>

  <audio id="bgMusic" preload="auto" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8c2e2fe0f7.mp3?filename=romantic-piano-112191.mp3" type="audio/mpeg">
  </audio>

  <audio id="noClickSfx" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_3b0d0d5b8f.mp3?filename=click-124467.mp3" type="audio/mpeg">
  </audio>

  <div id="sparkleLayer" aria-hidden="true"></div>
  <div id="flash" aria-hidden="true"></div>

  <div id="stamp" aria-hidden="true">
    <div class="stampRing">APPROVED</div>
    <div class="stampName">BY&nbsp;NUMO</div>
    <div class="stampSub">‚úÖ Chance Granted ‚úÖ</div>
  </div>

  <div class="modal" id="gifModal" role="dialog" aria-modal="true" aria-label="Celebration">
    <div class="modalCard">
      <div class="gifWrap">
        <img alt="Celebration GIF" src="https://media.giphy.com/media/26ufdipQqU2lhNA4g/giphy.gif">
      </div>
      <div class="modalBody">
        <div class="modalTitle">üíç HISTORIC MOMENT UNLOCKED üíç</div>
        <div class="modalHint">Numo has granted a chance. The universe is healing. Witnesses present. ü•π</div>
        <button class="closeBtn" id="closeModalBtn" type="button">Close</button>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="topRow">
      <div class="badge">Numo ‚Ä¢ A Special Request</div>
    </div>

    <h1>Numo, do you think i deserve a chance</h1>
    <p class="hint">Be honest‚Ä¶ but be gentle ü•∫</p>

    <div class="stage">
      <div class="playArea" id="playArea">
        <div class="btnRow" id="btnRow">
          <button class="yes" id="yesBtn" type="button">Yes</button>
          <button class="no" id="noBtn" type="button">No</button>
        </div>
      </div>

      <div class="msg" id="msg" aria-live="polite"></div>
      <div class="final" id="final"></div>
    </div>
  </div>

  <script>
    const noMessages = [
      "Are you sure",
      "You are not this cruel",
      "I know you dont want to do this",
      "Do you want to reconsider my heart is pleading",
      "This is not you I dont think you mean that",
      "Your heart is kinder than this",
      "You are breaking my fragile heart",
      "One more chance to decide."
    ];

    const yesMessage = "Thank you Numo, I knew you gonna give me a chance you just made my day.";
    const endNoMessage = "Now there‚Äôs only one beautiful option left ‚ú®";

    const bgFloat = document.getElementById("bgFloat");
    const playArea = document.getElementById("playArea");
    const btnRow = document.getElementById("btnRow");
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const msg = document.getElementById("msg");
    const final = document.getElementById("final");

    const gifModal = document.getElementById("gifModal");
    const closeModalBtn = document.getElementById("closeModalBtn");

    const bgMusic = document.getElementById("bgMusic");
    const noClickSfx = document.getElementById("noClickSfx");
    const sparkleLayer = document.getElementById("sparkleLayer");
    const flash = document.getElementById("flash");
    const stamp = document.getElementById("stamp");

    let noCount = 0;
    let noScale = 1;
    let noIsAbsolute = false;

    // YES irresistibility knobs
    let yesScale = 1;
    let yesGlow = 0.30;

    function setYesVisuals(){
      yesBtn.style.setProperty("--ys", String(yesScale));
      yesBtn.style.setProperty("--glow", String(yesGlow));
      yesBtn.style.boxShadow = `0 24px 70px rgba(255,77,160,${0.22 + (yesGlow*0.55)})`;
    }
    setYesVisuals();

    function growYes(){
      yesScale = Math.min(1.95, yesScale * 1.16);
      yesGlow  = Math.min(0.98, yesGlow + 0.08);
      setYesVisuals();

      yesBtn.animate(
        [
          { transform: `scale(${yesScale * 0.97})` },
          { transform: `scale(${yesScale * 1.05})` },
          { transform: `scale(${yesScale})` }
        ],
        { duration: 260, easing: "cubic-bezier(.2,.9,.2,1)" }
      );
    }

    function popMessage(text){
      msg.textContent = text;
      msg.animate(
        [
          { opacity: 0, transform: "translateY(6px)" },
          { opacity: 1, transform: "translateY(0px)" }
        ],
        { duration: 220, easing: "ease-out" }
      );
    }

    // Floating hearts/sparkles background (subtle)
    function spawnFloat(){
      const el = document.createElement("div");
      el.className = "floatItem";
      const items = ["‚ú¶", "‚ô°", "‚ùÄ", "‚úß", "‚ô•"];
      el.textContent = items[Math.floor(Math.random()*items.length)];
      el.style.left = (Math.random() * 100) + "vw";
      el.style.fontSize = (12 + Math.random()*22) + "px";
      el.style.animationDuration = (6000 + Math.random()*7000) + "ms";
      el.style.opacity = (0.06 + Math.random()*0.08).toFixed(2);
      bgFloat.appendChild(el);
      setTimeout(()=> el.remove(), 15000);
    }
    setInterval(spawnFloat, 450);

    // Music: start after gesture
    let musicArmed = false;
    function armMusicOnce(){
      if(musicArmed) return;
      musicArmed = true;
      bgMusic.volume = 0.55;
      bgMusic.play().catch(()=>{});
    }
    window.addEventListener("pointerdown", armMusicOnce, { once:true });

    function playNoSfx(){
      try{
        noClickSfx.currentTime = 0;
        noClickSfx.volume = 0.8;
        noClickSfx.play();
      }catch(e){}
    }

    function spawnSparkles(durationMs = 5500){
      const start = Date.now();
      const words = ["Numo ‚ú®", "NUMO ‚ú¶", "Numo üíó", "Numo üå∏", "Numo ‚ú®"];
      const sizes = [14, 16, 18, 20, 22];

      const timer = setInterval(() => {
        if(Date.now() - start > durationMs){ clearInterval(timer); return; }
        const el = document.createElement("div");
        el.className = "sparkle";
        el.textContent = words[Math.floor(Math.random()*words.length)];
        el.style.fontSize = sizes[Math.floor(Math.random()*sizes.length)] + "px";
        el.style.left = (Math.random() * (window.innerWidth - 60)) + "px";
        el.style.top = (window.innerHeight + 40) + "px";
        const travelTime = 2600 + Math.random()*2200;
        el.style.animationDuration = travelTime + "ms";
        sparkleLayer.appendChild(el);
        setTimeout(() => el.remove(), travelTime + 300);
      }, 120);
    }

    function flashScreen(){
      flash.classList.remove("flashOn");
      void flash.offsetWidth;
      flash.classList.add("flashOn");
    }

    function showApprovalStamp(){
      stamp.classList.remove("stampSlam","stampOut");
      void stamp.offsetWidth;
      stamp.classList.add("stampSlam");
      setTimeout(() => {
        stamp.classList.remove("stampSlam");
        stamp.classList.add("stampOut");
      }, 2200);
    }

    function removeNoShowFinal(){
      noBtn.style.opacity = "0";
      setTimeout(() => {
        noBtn.style.display = "none";
        final.textContent = endNoMessage;
      }, 240);
    }

    function shrinkNo(){
      noScale = Math.max(0.28, noScale * 0.84);
      const fontSize = Math.max(10, 16 * noScale);
      noBtn.style.fontSize = fontSize + "px";
      noBtn.style.transform = `translate(0,0) scale(${noScale})`;
      noBtn.style.opacity = String(Math.max(0.20, 1 - noCount * 0.09));
    }

    function shakeNo(){
      noBtn.animate(
        [
          { transform: `translate(0,0) scale(${noScale}) rotate(0deg)` },
          { transform: `translate(-4px,0) scale(${noScale}) rotate(-1deg)` },
          { transform: `translate(4px,0) scale(${noScale}) rotate(1deg)` },
          { transform: `translate(-3px,0) scale(${noScale}) rotate(-0.8deg)` },
          { transform: `translate(3px,0) scale(${noScale}) rotate(0.8deg)` },
          { transform: `translate(0,0) scale(${noScale}) rotate(0deg)` }
        ],
        { duration: 260, easing: "ease-in-out" }
      );
    }

    // Tiny ‚Äúsad confetti‚Äù for No clicks
    function sadBurst(x, y){
      // quick small particles, muted pink
      for(let i=0;i<26;i++){
        particles.push({
          x, y,
          vx: (Math.random()-0.5)*3.2,
          vy: -1 - Math.random()*3.0,
          life: 30 + Math.random()*20,
          size: 1 + Math.random()*2.2,
          g: 0.12,
          hue: 330 + Math.random()*20,
          trail: []
        });
      }
      running = true;
      requestAnimationFrame(draw);
    }

    function ensureNoAbsolute(){
      if(noIsAbsolute) return;

      const areaRect = playArea.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();

      const x0 = btnRect.left - areaRect.left;
      const y0 = btnRect.top - areaRect.top;

      playArea.appendChild(noBtn);

      noBtn.style.position = "absolute";
      noBtn.style.left = `${x0}px`;
      noBtn.style.top  = `${y0}px`;
      noBtn.style.transform = `translate(0,0) scale(${noScale})`;
      noBtn.style.zIndex = "3";

      noIsAbsolute = true;
    }

    function moveNoButton(){
      const areaRect = playArea.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();
      const pad = 18;

      const maxX = areaRect.width - btnRect.width - pad;
      const maxY = areaRect.height - btnRect.height - pad;

      const x = Math.random() * Math.max(pad, maxX) + pad;
      const y = Math.random() * Math.max(pad, maxY) + pad;

      noBtn.style.left = `${x}px`;
      noBtn.style.top  = `${y}px`;
      noBtn.style.transform = `translate(0,0) scale(${noScale})`;
    }

    // Magnet effect on YES hover (desktop)
    yesBtn.addEventListener("mousemove", (e) => {
      const r = yesBtn.getBoundingClientRect();
      const dx = (e.clientX - (r.left + r.width/2)) / (r.width/2);
      const dy = (e.clientY - (r.top + r.height/2)) / (r.height/2);
      const pull = 3;
      yesBtn.style.transform = `translate(${dx*pull}px, ${dy*pull}px) scale(${yesScale})`;
    });
    yesBtn.addEventListener("mouseleave", () => {
      yesBtn.style.transform = `scale(${yesScale})`;
    });

    // Fireworks canvas
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d");
    function resizeCanvas(){
      const dpr = window.devicePixelRatio || 1;
      canvas.width = window.innerWidth * dpr;
      canvas.height = window.innerHeight * dpr;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    let particles = [];
    let running = false;

    function burst(x, y, count=110){
      for(let i=0;i<count;i++){
        const a = Math.random() * Math.PI * 2;
        const s = 2 + Math.random() * 7;
        particles.push({
          x, y,
          vx: Math.cos(a) * s,
          vy: Math.sin(a) * s,
          life: 46 + Math.random()*40,
          size: 1 + Math.random()*3.2,
          g: 0.08 + Math.random()*0.10,
          hue: Math.floor(Math.random()*360),
          trail: []
        });
      }
    }

    function sparkleRain(count=180){
      for(let i=0;i<count;i++){
        particles.push({
          x: Math.random()*window.innerWidth,
          y: -10,
          vx: (Math.random()-0.5)*1.2,
          vy: 2 + Math.random() * 3.8,
          life: 70 + Math.random() * 50,
          size: 0.8 + Math.random()*2.4,
          g: 0.03,
          hue: Math.floor(Math.random()*360),
          trail: []
        });
      }
    }

    function draw(){
      if(!running) return;
      ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
      particles = particles.filter(p => p.life > 0);

      for(const p of particles){
        p.life -= 1;
        p.vy += p.g;
        p.x += p.vx;
        p.y += p.vy;

        p.trail.push({x:p.x, y:p.y});
        if(p.trail.length > 9) p.trail.shift();

        ctx.beginPath();
        for(let i=0;i<p.trail.length;i++){
          const t = p.trail[i];
          if(i===0) ctx.moveTo(t.x, t.y);
          else ctx.lineTo(t.x, t.y);
        }
        ctx.strokeStyle = `hsla(${p.hue}, 95%, 60%, 0.18)`;
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
        ctx.fillStyle = `hsla(${p.hue}, 98%, 60%, 0.90)`;
        ctx.fill();
      }

      if(particles.length === 0){
        running = false;
        ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
        return;
      }
      requestAnimationFrame(draw);
    }

    function celebrate(){
      running = true;
      const cx = window.innerWidth/2;
      const cy = window.innerHeight/2;

      burst(cx - 200, cy - 140, 110);
      burst(cx + 190, cy - 170, 120);
      burst(cx, cy - 110, 130);
      sparkleRain(220);

      setTimeout(() => burst(cx - 90, cy - 230, 100), 220);
      setTimeout(() => burst(cx + 70, cy - 240, 100), 380);
      setTimeout(() => sparkleRain(160), 520);

      requestAnimationFrame(draw);
    }

    function extraFireworksWaves(){
      const cx = window.innerWidth/2;
      const cy = window.innerHeight/2;
      setTimeout(() => burst(cx - 260, cy - 120, 120), 650);
      setTimeout(() => burst(cx + 260, cy - 140, 120), 820);
      setTimeout(() => burst(cx, cy - 260, 140), 1050);
      setTimeout(() => sparkleRain(220), 1150);
    }

    function showGifModal(){ gifModal.style.display = "grid"; }
    function hideGifModal(){ gifModal.style.display = "none"; }
    closeModalBtn.addEventListener("click", hideGifModal);
    gifModal.addEventListener("click", (e) => { if(e.target === gifModal) hideGifModal(); });

    // NO click sequence
    noBtn.addEventListener("click", () => {
      if(noBtn.style.display === "none") return;

      armMusicOnce();
      playNoSfx();

      noCount += 1;
      if(noCount > 8) return;

      popMessage(noMessages[noCount - 1]);

      // tiny sad confetti at current button center
      const r = noBtn.getBoundingClientRect();
      sadBurst(r.left + r.width/2, r.top + r.height/2);

      shakeNo();

      setTimeout(() => {
        growYes();
        ensureNoAbsolute();
        shrinkNo();
        moveNoButton();

        if(noCount === 8){
          setTimeout(removeNoShowFinal, 520);
        }
      }, 160);
    });

    // YES click
    yesBtn.addEventListener("click", () => {
      armMusicOnce();
      noBtn.style.display = "none";
      final.textContent = "";

      msg.textContent = yesMessage;
      msg.classList.add("dramatic", "legendaryYes");

      final.innerHTML = "";
      const toBe = document.createElement("div");
      toBe.className = "toBe";
      toBe.textContent = "‚Äî TO BE CONTINUED‚Ä¶ üé¨ ‚Äî";
      final.appendChild(toBe);

      celebrate();
      extraFireworksWaves();
      spawnSparkles(6000);
      showGifModal();

      flashScreen();
      showApprovalStamp();

      msg.animate(
        [
          { transform: "translateY(0px) scale(1)" },
          { transform: "translateY(-10px) scale(1.03)" },
          { transform: "translateY(0px) scale(1)" }
        ],
        { duration: 1200, iterations: 1, easing: "cubic-bezier(.2,.9,.2,1)" }
      );
    });
  </script>
</body>
</html>
